{% load static %}

<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>–ü–ª–∞–Ω —ç—Ç–∞–∂–∞ {{ floor_id }} ‚Äî –ø–µ—á–∞—Ç—å</title>

  <link rel="stylesheet" href="{% static 'macro/keyrate_print.css' %}">

  {# –õ–û–ö–ê–õ–¨–ù–´–ô –û–í–ï–†–†–ê–ô–î: —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ #}
  <style>
    /* –ü–µ—á–∞—Ç–∞–µ–º –≤ –∞–ª—å–±–æ–º–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ */
    @media print {
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

    .floor-print-page .plan-svg-wrapper {
      margin-top: 14px;
      border-radius: 18px;
      border: 1px solid #e5e7eb;
      padding: 12px;
      background: #f9fafb;
    }

    .floor-print-page .plan-svg-wrapper svg {
      width: 100%;
      height: auto;
      max-height: 17cm;
    }

    .floor-print-page .legend-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 18px;
      align-items: center;
      margin-top: 10px;
      font-size: 12px;
      color: #4b5563;
    }

    .floor-print-page .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .floor-print-page .comment-box {
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      height: 120px;
      margin-top: 8px;
    }
  </style>
</head>

<body class="floor-print-page">
<div class="page-wrap">
  <div class="card">

    {# –¢–£–õ–ë–ê–† #}
    <div class="toolbar">
      <a href="javascript:window.close()" class="btn-back">
        ‚Üê –ó–∞–∫—Ä—ã—Ç—å
      </a>

      <button class="btn-print" onclick="window.print()">
        <span class="icon">üñ®</span>
        <span>–ü–µ—á–∞—Ç—å</span>
      </button>
    </div>

    {# –®–ê–ü–ö–ê #}
    <div class="header">
      <div class="title-block">
        <div class="title-label">–ê–†–ï–ù–î–ê ¬∑ –ü–õ–ê–ù –≠–¢–ê–ñ–ê</div>
        <h1>–ü–ª–∞–Ω —ç—Ç–∞–∂–∞ {{ floor_id }}</h1>

        <div class="subtitle">
          –ü–µ—á–∞—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø–ª–∞–Ω–∞ —ç—Ç–∞–∂–∞ —Å —É—á—ë—Ç–æ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–∞—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è,
          —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π —Å
          –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–∞–º–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞.
        </div>
      </div>

      <div class="tag">
        –í–ù–£–¢–†–ï–ù–ù–ò–ô –î–û–ö–£–ú–ï–ù–¢
      </div>
    </div>

    {# I. –°–í–û–î–ö–ê #}
    <div class="section">
      <div class="section-title">–°–≤–æ–¥–∫–∞ –ø–æ –ø–ª–∞–Ω—É</div>

      <div class="summary-grid">

        <div class="summary-item">
          <div class="summary-label">–ö–û–õ–ò–ß–ï–°–¢–í–û –ü–û–ú–ï–©–ï–ù–ò–ô</div>
          <div class="summary-value">
            {{ total_premises }}
          </div>
          <div class="summary-sub">
            –ù–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–∞—Ç–µ<br>—Å–æ—Å—Ç–æ—è–Ω–∏—è
          </div>
        </div>

        <div class="summary-item">
          <div class="summary-label">–°–£–ú–ú–ê–†–ù–ê–Ø –ü–õ–û–©–ê–î–¨</div>
          <div class="summary-value">
            {% if total_area %}
              {{ total_area|floatformat:2 }}&nbsp;–º¬≤
            {% else %}
              ‚Äî
            {% endif %}
          </div>
          <div class="summary-sub">
            –ü–æ –≤—Å–µ–º<br>–æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–º –ø–æ–º–µ—â–µ–Ω–∏—è–º
          </div>
        </div>

        <div class="summary-item">
          <div class="summary-label">–í–´–î–ï–õ–ï–ù–û –ù–ê –ü–õ–ê–ù–ï</div>
          <div class="summary-value">
            {{ selected_count }}
          </div>
          <div class="summary-sub">
            –ü–æ–º–µ—â–µ–Ω–∏—è —Å<br>–∫—Ä–∞—Å–Ω—ã–º –∫–æ–Ω—Ç—É—Ä–æ–º
          </div>
        </div>

        <div class="summary-item">
          <div class="summary-label">–î–ê–¢–ê –°–û–°–¢–û–Ø–ù–ò–Ø ¬∑ –ü–ï–ß–ê–¢–ò</div>
          <div class="summary-value">
            {{ current_date|date:"d.m.Y" }}
          </div>
          <div class="summary-sub">
            –ü–µ—á–∞—Ç—å: {{ print_date|date:"d.m.Y H:i" }}
          </div>
        </div>

      </div>

      {# –¶–≤–µ—Ç–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ #}
      <div class="legend-row">
        <div class="legend-item">
          <span style="
            display:inline-block;width:10px;height:10px;border-radius:999px;
            background:#f8d7da;border:1px solid #dc3545;
          "></span>
          <span>–ó–∞–Ω—è—Ç–æ ({{ status_occupied }})</span>
        </div>

        <div class="legend-item">
          <span style="
            display:inline-block;width:10px;height:10px;border-radius:999px;
            background:#d4edda;border:1px solid #28a745;
          "></span>
          <span>–°–≤–æ–±–æ–¥–Ω–æ ({{ status_free }})</span>
        </div>

        <div class="legend-item">
          <span style="
            display:inline-block;width:10px;height:10px;border-radius:999px;
            background:#fff3cd;border:1px solid #ffc107;
          "></span>
          <span>–ù–µ –∏–∑–≤–µ—Å—Ç–Ω–æ ({{ status_unknown }})</span>
        </div>

        <div class="legend-item">
          <span style="
            display:inline-block;width:10px;height:10px;border-radius:999px;
            background:#e5e7eb;border:1px solid #9ca3af;
          "></span>
          <span>–ë–µ–∑ —Å—Ç–∞—Ç—É—Å–∞ ({{ status_none }})</span>
        </div>
      </div>
    </div>

    {# II. –ì–†–ê–§–ò–ö –ü–õ–ê–ù–ê #}
    <div class="section section-divider">
      <div class="section-title">–ü–ª–∞–Ω —ç—Ç–∞–∂–∞ (–≥—Ä–∞—Ñ–∏–∫)</div>
      <div class="section-sub">
        –ü–æ–º–µ—â–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ —Ä–µ–∂–∏–º–æ–º –∑–∞–ª–∏–≤–∫–∏.
        –í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Dash –ø–æ–º–µ—â–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º –∫–æ–Ω—Ç—É—Ä–æ–º.
      </div>

      <div class="plan-svg-wrapper">
        {{ floor_svg|safe }}
      </div>

      {% if selected_count == 0 %}
        <div class="section-sub" style="margin-top:8px;">
          –ù–∞ –ø–ª–∞–Ω–µ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ–º–µ—â–µ–Ω–∏–π.
        </div>
      {% endif %}
    </div>

    {# III. –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò #}
    <div class="section section-divider">
      <div class="section-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è</div>
      <div class="section-sub">
        –ë–ª–æ–∫ –¥–ª—è —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö –ø–æ–º–µ—Ç–æ–∫ –ø—Ä–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è.
      </div>

      <div class="comment-box"></div>
    </div>

    {# –ü–û–î–í–ê–õ #}
    <div class="footer-note" style="margin-top:32px; padding-top:12px; border-top:1px solid #e5e7eb; color:#6b7280; font-size:12px; line-height:1.5;">
      <div>
        –î–æ–∫—É–º–µ–Ω—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω: <strong>{{ print_date|date:"d.m.Y H:i" }}</strong>.
      </div>
      <div style="margin-top:6px;">
        –ü–µ—á–∞—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–∞–≤–∞ –ø–æ–º–µ—â–µ–Ω–∏–π
        —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –¥–æ–∫—É–º–µ–Ω—Ç–∞.
      </div>
    </div>

  </div>
</div>
</body>
</html>

