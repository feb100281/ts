{% extends "admin/base_site.html" %}
{% load static %}

{# Ğ¡Ğ²Ğ¾Ğ¸ breadcrumbs Ñ€Ğ¸ÑÑƒĞµĞ¼ ÑĞ°Ğ¼Ğ¸ Ğ²Ğ½Ğ¸Ğ·Ñƒ #}
{% block breadcrumbs %}{% endblock %}



{% block extrastyle %}
{{ block.super }}
<style>
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       Ğ¥ĞµĞ´ĞµÑ€ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .macro-page-header {
        display: flex;
        align-items: flex-start;
        gap: 16px;
        flex-wrap: wrap;
        padding-bottom: 6px;
        margin-bottom: 4px;
    }

    .macro-header-left {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        flex-wrap: wrap;
    }

    .macro-avatar {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background: linear-gradient(135deg, #1d4ed8, #38bdf8);
        color: #eff6ff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 600;
        box-shadow: 0 0 0 1px rgba(15,23,42,.12), 0 10px 25px rgba(15,23,42,.25);
    }

    .macro-header-text {
        display: flex;
        flex-direction: column;
        gap: 4px;
        line-height: 1.3;
    }

    .macro-header-kicker {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        color: #6b7280;
    }

    .macro-header-title {
        font-size: 19px;
        font-weight: 600;
        color: #111827;
    }

    .macro-header-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 2px;
    }

    .macro-badge {
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 6px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .macro-badge-year {
        background: #e0f2fe;
        color: #1d4ed8;
    }

    .macro-badge-info {
        background: #eff6ff;
        color: #1d4ed8;
        font-weight: 500;
    }

    .macro-header-right {
        flex: 1;
        display: flex;
        justify-content: flex-end;
        min-width: 260px;
        max-width: 340px;
    }

    .macro-header-card {
        border-radius: 14px;
        background: rgba(248,250,252,0.96);
        box-shadow: 0 18px 40px rgba(15,23,42,0.16);
        padding: 10px 12px 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .macro-header-card-top {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
    }

    .macro-header-card-label {
        font-size: 11px;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        color: #9ca3af;
    }

    .macro-header-card-title {
        font-size: 13px;
        font-weight: 600;
        color: #0f172a;
    }

    .macro-header-card-hint {
        font-size: 11px;
        color: #6b7280;
        line-height: 1.4;
        margin-top: 2px;
    }

    .macro-header-card-actions {
        display: flex;
        flex-direction: column;
        gap: 6px;
        margin-top: 4px;
    }

    .macro-header-inline {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
    }

    .macro-year-input {
        width: 90px !important;
        padding: 2px 4px;
        font-size: 12px;
    }

    .macro-btn-sm {
        font-size: 12px !important;
        padding: 3px 10px !important;
        border-radius: 6px !important;
        line-height: 1.3 !important;
    }

    .macro-btn-secondary {
        background: #e5e7eb;
        border-color: #d1d5db;
        color: #374151;
    }

    .macro-btn-secondary:hover {
        background: #d1d5db;
        color: #111827;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞĞ¸Ğ¶Ğ½ÑÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .macro-subfooter {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 4px;
        padding: 6px 2px 0;
        border-top: 1px solid #e5e7eb;
        color: #6b7280;
        font-size: 11px;
    }

    .macro-subfooter-nav {
        display: flex;
        align-items: center;
        gap: 4px;
        flex-wrap: wrap;
    }

    .macro-subfooter-nav a {
        text-transform: uppercase;
        letter-spacing: 0.08em;
        text-decoration: none;
        color: #9ca3af;
    }

    .macro-subfooter-nav span.section {
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #9ca3af;
    }

    .macro-subfooter-nav span.current {
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #4b5563;
        font-weight: 600;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞĞ±Ñ‘Ñ€Ñ‚ĞºĞ° ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ñ
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .calendar-wrapper {
        width: 100%;
        margin-top: 10px;
        padding: 8px 0 2px;
    }

    .calendar-shell {
        border-radius: 14px;
        border: 1px solid #e5e7eb;
        background: #f9fafb;
        padding: 12px 12px 8px;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       1 ĞºĞ²Ğ°Ñ€Ñ‚Ğ°Ğ» = 3 Ğ¼ĞµÑÑÑ†Ğ° + ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ°
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .quarter-row {
        display: grid;
        grid-template-columns: 3fr 1.05fr;
        gap: 18px;
        margin-bottom: 18px;
        align-items: stretch;
    }

    .quarter-months {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 14px;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞšĞĞ Ğ¢ĞĞ§ĞšĞ ĞšĞ’ĞĞ Ğ¢ĞĞ›Ğ â€” ÑĞ¿Ğ¾ĞºĞ¾Ğ¹Ğ½Ğ°Ñ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ°
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .quarter-summary {
        background: #f9fafb;
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        padding: 14px 16px 12px 20px;
        font-size: 13px;
        box-shadow: none;
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 8px;
        overflow: hidden;
    }

    /* Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ÑÑ ÑĞ¸Ğ½ÑÑ Ñ€ĞµĞ¹ĞºĞ° ÑĞ»ĞµĞ²Ğ°, Ğ½Ğµ Ğ´Ğ¾ ĞºÑ€Ğ°Ñ‘Ğ² â€”
       ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğµ ĞµĞ´Ğ¸Ğ½Ğ¾Ğ¹ Â«ÑˆĞ¸Ğ½Ñ‹Â» Ğ¿Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¼Ñƒ ĞºÑ€Ğ°Ñ ÑĞºÑ€Ğ°Ğ½Ğ° */
    .quarter-summary::before {
        content: "";
        position: absolute;
        left: 10px;
        top: 8px;
        bottom: 8px;
        width: 3px;
        background: linear-gradient(180deg, #1d4ed8, #38bdf8);
        border-radius: 6px;
        opacity: 0.9;
    }

    .quarter-title {
        font-weight: 700;
        font-size: 14px;
        color: #0f172a;
        margin-bottom: 0;
    }

    .quarter-caption {
        font-size: 11px;
        color: #6b7280;
    }

    .quarter-list {
        list-style: none;
        padding: 8px 0 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 6px;
        border-top: 1px dashed #e5e7eb;
    }

    .quarter-list li {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 13px;
        color: #334155;
    }

    .qs-icon {
        width: 9px;
        height: 9px;
        border-radius: 50%;
        margin-right: 8px;
        flex-shrink: 0;
        box-shadow: 0 0 0 2px rgba(148,163,184,0.18);
    }

    .qs-total    .qs-icon { background: #9ca3af; }
    .qs-work     .qs-icon { background: #22c55e; box-shadow:0 0 0 2px rgba(34,197,94,0.18); }
    .qs-weekend  .qs-icon { background: #fb923c; box-shadow:0 0 0 2px rgba(251,146,60,0.2); }
    .qs-holidays .qs-icon { background: #ef4444; box-shadow:0 0 0 2px rgba(239,68,68,0.2); }

    .qs-label {
        display: flex;
        align-items: center;
        gap: 6px;
        color: #475569;
        font-weight: 500;
    }

    .qs-value {
        font-weight: 700;
        color: #0f172a;
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       ĞœĞ•Ğ¡Ğ¯Ğ¦Ğ«
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .month-card {
        background: #ffffff;
        padding: 12px 14px;
        border-radius: 10px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 6px 14px rgba(15,23,42,0.06);
    }

    .month-title {
        text-align: center;
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #111827;
    }

    .month-table {
        width: 100%;
        font-size: 11px;
        text-align: center;
        border-collapse: collapse;
    }

    .month-table th {
        padding-bottom: 4px;
        font-weight: 600;
        color: #374151;
    }

    .month-table td {
        padding: 2px 0;
        height: 18px;
    }

    .weekend {
        color: #c0392b;
    }

    td.empty {
        background: #f5f6f7;
    }

    .workday {
        background: #e4f9e7;
    }

    .offday {
        background: #ffe5e5;
    }

    .today {
        border: 2px solid #1d4ed8;
        border-radius: 4px;
        font-weight: 700;
        background: #dbeafe;
    }


    .macro-breadcrumbs {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-top: 4px;
    font-size: 11px;
    color: #6b7280;
}

.macro-breadcrumbs a {
    text-decoration: none;
    color: #9ca3af;
    text-transform: uppercase;
    letter-spacing: 0.06em;
}

.macro-breadcrumbs span {
    color: #9ca3af;
    text-transform: uppercase;
    letter-spacing: 0.06em;
}

.macro-breadcrumbs .current {
    color: #4b5563;
    font-weight: 600;
}




</style>
{% endblock %}

{% block content %}

<div class="macro-page-header">

    <div class="macro-header-left">
        <div class="macro-avatar">
            ğŸ“…
        </div>

        <div class="macro-header-text">
            <span class="macro-header-kicker">
                ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ÑŒ
            </span>

            <span class="macro-header-title">
                ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ÑŒ
            </span>

            <div class="macro-header-badges">
                <span class="macro-badge macro-badge-year">
                    Ğ“Ğ¾Ğ´: {{ year_str }}
                </span>

                <span class="macro-badge macro-badge-info">
                    Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞ¹Ñ‚Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¼Ğ¸ Ğ¸ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ½ÑĞ¼Ğ¸ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ¾Ğ²
                </span>
            </div>

            <nav class="macro-breadcrumbs">
    <a href="{% url 'admin:index' %}">ĞĞĞ§ĞĞ›Ğ</a>
    <span>â€º</span>
    <span>Ğ¡ĞŸĞ ĞĞ’ĞĞ§ĞĞ˜ĞšĞ˜</span>
    <span>â€º</span>
    <span class="current">ĞšĞĞ›Ğ•ĞĞ”ĞĞ Ğ¬</span>
</nav>
        </div>
    </div>

    <div class="macro-header-right">
        <div class="macro-header-card">
            <div class="macro-header-card-top">
                <span class="macro-header-card-label">ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ</span>
                <span class="macro-header-card-title">Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ</span>
            </div>

            <div class="macro-header-card-hint">
                Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ³Ğ¾Ğ´ Ğ¸ Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€Ñ.
            </div>

            <div class="macro-header-card-actions">
                <form method="get" class="macro-header-inline">
                    <label for="id_year" style="font-size:11px;color:#6b7280;">Ğ“Ğ¾Ğ´:</label>
                    <input id="id_year"
                           type="number"
                           name="year"
                           value="{{ year_str }}"
                           min="2000"
                           max="2100"
                           class="macro-year-input">
                    <button class="btn btn-primary macro-btn-sm" type="submit">
                        ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ
                    </button>
                </form>

<a href="{% url 'admin:macro_calendarexceptions_load' %}?year={{ year_str }}"
   class="btn macro-btn-sm macro-btn-secondary macro-btn-icon">
    <span class="icon">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M20 16.58A5 5 0 0 0 18 7h-1.26A8 8 0 1 0 4 15.25" />
  <path d="M12 12v9" />
  <path d="M8 17l4 4 4-4" />
</svg>

    </span>
    <span>Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ ĞºĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€ÑŒ</span>
</a>

<a href="{% url 'admin:macro_calendarexceptions_print' %}?year={{ year_str }}"
   class="btn macro-btn-sm macro-btn-secondary macro-btn-icon">
    <span class="icon">
        ğŸ–¨
    </span>
    <span>ĞŸĞµÑ‡Ğ°Ñ‚Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ</span>
</a>


            </div>
        </div>
    </div>

</div>



<div class="calendar-wrapper">
    <div class="calendar-shell">
        {{ calendar_html|safe }}
    </div>
</div>

{% endblock %}





