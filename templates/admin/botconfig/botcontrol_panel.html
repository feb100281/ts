{% extends "admin/change_list.html" %}
{% load static %}
{% load admin_urls %}

{# —É–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫—Ä–æ—à–∫–∏ –∏ –∑–µ–ª—ë–Ω—É—é –∫–Ω–æ–ø–∫—É #}
{% block breadcrumbs %}{% endblock %}
{% block object-tools %}{% endblock %}

{# –®–ê–ü–ö–ê –ü–ê–ù–ï–õ–ò #}
{% block content_title %}
  <div style="display:flex; align-items:flex-start; gap:16px; flex-wrap:wrap; padding-bottom:6px;">

    {# –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ #}
    <div style="display:flex; align-items:flex-start; gap:12px; flex-wrap:wrap;">

      {# –ê–≤–∞—Ç–∞—Ä –±–æ—Ç–∞ #}
      <div style="
          width:44px;
          height:44px;
          border-radius:12px;
          background:radial-gradient(circle at 0 0, #22c55e 0, #16a34a 40%, #064e3b 100%);
          color:#ecfdf5;
          display:flex;
          align-items:center;
          justify-content:center;
          font-size:24px;
          font-weight:600;
          box-shadow:0 0 0 1px rgba(15,23,42,.20), 0 18px 40px rgba(15,23,42,0.45);
      ">
        ü§ñ
      </div>

      <div style="display:flex; flex-direction:column; gap:4px; line-height:1.3;">

        <span style="
            font-size:11px;
            text-transform:uppercase;
            letter-spacing:0.08em;
            color:#6b7280;
        ">
          Telegram-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
        </span>

        <span style="font-size:20px; font-weight:600; color:#0f172a;">
          –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Telegram-–±–æ—Ç–æ–º
        </span>

        <div style="display:flex; flex-wrap:wrap; gap:6px; margin-top:2px;">

          {# –°—Ç–∞—Ç—É—Å (–ø–æ–∫–∞ —Å—Ç–∞—Ç–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç) #}
          <span style="
              font-size:11px;
              padding:3px 9px;
              border-radius:6px;
              background:#ecfdf3;
              color:#15803d;
              font-weight:600;
              border:1px solid rgba(22,163,74,0.40);
              display:inline-flex;
              align-items:center;
              gap:6px;
          ">
            <span style="width:7px;height:7px;border-radius:6px;background:#22c55e;"></span>
            –ë–æ—Ç –ø–æ–¥–∫–ª—é—á—ë–Ω –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
          </span>

          <span style="
              font-size:11px;
              padding:3px 9px;
              border-radius:6px;
              background:#eff6ff;
              color:#1d4ed8;
              font-weight:500;
              border:1px solid rgba(59,130,246,0.35);
          ">
            –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ—Ç–∞ –∏ –∫–æ–º–∞–Ω–¥—ã
          </span>

          {# –ß–∏–ø: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ #}
          <span style="
              font-size:11px;
              padding:3px 9px;
              border-radius:6px;
              background:#ecfeff;
              color:#0e7490;
              font-weight:600;
              border:1px solid rgba(8,145,178,0.35);
          ">
            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: {{ allowed_users|default:"0" }}/{{ total_users|default:"0" }} —Å –¥–æ—Å—Ç—É–ø–æ–º
          </span>

          {# –ß–∏–ø: –∫–æ–º–∞–Ω–¥—ã #}
          <span style="
              font-size:11px;
              padding:3px 9px;
              border-radius:6px;
              background:#f5f3ff;
              color:#6d28d9;
              font-weight:600;
              border:1px solid rgba(124,58,237,0.35);
          ">
            –ö–æ–º–∞–Ω–¥—ã: {{ active_commands|default:"0" }}/{{ total_commands|default:"0" }} –∞–∫—Ç–∏–≤–Ω—ã
          </span>
        </div>
      </div>
    </div>

    {# –°–ø–µ–π—Å–µ—Ä #}
    <div style="flex:1;"></div>

    {# –ü–†–ê–í–ê–Ø –ö–ê–†–¢–û–ß–ö–ê: –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è #}
    <div style="
        min-width:260px;
        max-width:320px;
        border-radius:16px;
        background:rgba(248,250,252,0.98);
        box-shadow:0 18px 40px rgba(15,23,42,0.18);
        padding:10px 12px 12px;
        display:flex;
        flex-direction:column;
        gap:8px;
    ">
      <div style="display:flex;justify-content:space-between;align-items:baseline;">
        <span style="
            font-size:11px;
            letter-spacing:0.14em;
            text-transform:uppercase;
            color:#9ca3af;
        ">
          –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
        </span>
        <span style="font-size:13px;font-weight:600;color:#0f172a;">
          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        </span>
      </div>

      <div style="display:flex;flex-direction:column;gap:6px;margin-top:2px;">

        {# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ / —Å—Ç–∞—Ç—É—Å #}
        <a href="{% url 'admin:bot_check_status' %}"
           class="button"
           style="
             font-size:13px;
             padding:5px 10px;
             border-radius:8px;
             display:inline-flex;
             align-items:center;
             gap:6px;
             justify-content:flex-start;
             background:#e0f2fe;
           ">
          üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å
        </a>

        {# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ #}
        <a href="{% url 'admin:bot_restart' %}"
           class="button"
           style="
             font-size:13px;
             padding:5px 10px;
             border-radius:8px;
             display:inline-flex;
             align-items:center;
             gap:6px;
             justify-content:flex-start;
             background:#fef3c7;
           ">
          üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
        </a>

        {# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞ #}
        <a href="{% url 'admin:botconfig_botuser_changelist' %}"
           class="button"
           style="
             font-size:13px;
             padding:5px 10px;
             border-radius:8px;
             display:inline-flex;
             align-items:center;
             gap:6px;
             justify-content:flex-start;
           ">
          üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞
        </a>

        {# –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ #}
        <a href="{% url 'admin:botconfig_botcommand_changelist' %}"
           class="button"
           style="
             font-size:13px;
             padding:5px 10px;
             border-radius:8px;
             display:inline-flex;
             align-items:center;
             gap:6px;
             justify-content:flex-start;
           ">
          üí¨ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
        </a>

        {# –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö #}
        <a href="{% url 'admin:botconfig_botdatasource_changelist' %}"
           class="button"
           style="
             font-size:13px;
             padding:5px 10px;
             border-radius:8px;
             display:inline-flex;
             align-items:center;
             gap:6px;
             justify-content:flex-start;
           ">
          üìä –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        </a>
      </div>

      <div style="
          margin-top:6px;
          padding:6px 8px;
          border-radius:10px;
          background:linear-gradient(to right, rgba(15,23,42,0.02), rgba(15,23,42,0.06));
          border:1px dashed rgba(148,163,184,0.7);
          font-size:11px;
          color:#4b5563;
          display:flex;
          gap:6px;
          align-items:flex-start;
      ">
        <span style="font-size:13px;line-height:1;">‚ÑπÔ∏è</span>
        <span>
          –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–∞–Ω–¥–∞—Ö –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
          –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏–∫–µ Telegram-–±–æ—Ç–∞ (–ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –≤–æ—Ä–∫–µ—Ä–∞).
        </span>
      </div>

      {# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ / –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ #}
      {% if status_info or restart_info %}
        <div style="
            margin-top:6px;
            padding:6px 8px;
            border-radius:10px;
            background:#f9fafb;
            border:1px solid #e5e7eb;
            font-size:11px;
            color:#4b5563;
            display:flex;
            flex-direction:column;
            gap:4px;
        ">
          {% if status_info %}
            <div>
              <strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</strong><br>
              {{ status_info.summary }}<br>
            </div>
          {% endif %}
          {% if restart_info %}
            <div>
              <strong>–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:</strong><br>
              {{ restart_info.summary }}
            </div>
          {% endif %}
        </div>
      {% endif %}
    </div>

  </div>

  {# –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ (–∫–∞—Å—Ç–æ–º–Ω—ã–µ ¬´–∫—Ä–æ—à–∫–∏¬ª) #}
  <div style="
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-top:4px;
      padding:6px 2px 0;
      border-top:1px solid #e5e7eb;
      color:#6b7280;
      font-size:11px;
  ">
    <nav style="display:flex;align-items:center;gap:4px;flex-wrap:wrap;">
      <a href="{% url 'admin:index' %}" style="text-transform:uppercase;letter-spacing:0.08em;text-decoration:none;color:#9ca3af;">
        –ù–ê–ß–ê–õ–û
      </a>
      <span>‚Ä∫</span>
      <span style="text-transform:uppercase;letter-spacing:0.08em;color:#9ca3af;">
        –ò–ù–¢–ï–ì–†–ê–¶–ò–ò
      </span>
      <span>‚Ä∫</span>
      <span style="text-transform:uppercase;letter-spacing:0.08em;color:#4b5563;font-weight:600;">
        TELEGRAM-–ë–û–¢
      </span>
    </nav>

    <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
      <span style="color:#9ca3af;">
        –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª—ã –≤—ã—à–µ
      </span>
    </div>
  </div>
{% endblock %}


{# –û–°–ù–û–í–ù–û–ï –°–û–î–ï–†–ñ–ò–ú–û–ï –ü–ê–ù–ï–õ–ò #}
{% block result_list %}
  {# –ü–ï–†–í–ê–Ø –°–¢–†–û–ö–ê: –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ + —á–µ–∫-–ª–∏—Å—Ç #}
  <div style="margin-top:18px; display:grid; grid-template-columns: minmax(0,2fr) minmax(0,1.4fr); gap:18px; align-items:flex-start;">

    {# –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∏ —Å—Ö–µ–º–∞ #}
    <section style="
        border-radius:14px;
        background:white;
        box-shadow:0 14px 30px rgba(15,23,42,0.08);
        padding:14px 16px 16px;
        border:1px solid #e5e7eb;
        font-size:13px;
        color:#374151;
    ">
      <h2 style="font-size:14px;font-weight:600;margin:0 0 8px;color:#111827;">
        –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram-–±–æ—Ç–∞
      </h2>
      <p style="margin:0 0 8px;">
        –≠—Ç–∞ –ø–∞–Ω–µ–ª—å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Å—É—â–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã Telegram-–±–æ—Ç–∞
        –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:
      </p>

      <ul style="margin:0 0 8px 18px;padding:0;list-style:disc;">
        <li style="margin-bottom:4px;">
          <strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ—Ç–∞</strong> ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ Telegram-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ Django-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
          –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –±–æ—Ç—É.
        </li>
        <li style="margin-bottom:4px;">
          <strong>–ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞</strong> ‚Äî —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥, –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –¥–∞–Ω–Ω—ã—Ö.
        </li>
        <li style="margin-bottom:4px;">
          <strong>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö</strong> ‚Äî –æ—Ç–∫—É–¥–∞ –±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ (–º–æ–¥–µ–ª–∏, –ª–∏–º–∏—Ç—ã, —Ñ–∏–ª—å—Ç—Ä—ã).
        </li>
      </ul>

      <p style="margin:0 0 10px;">
        –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –≤–µ–±—Ö—É–∫–∏) –≤–Ω–æ—Å—è—Ç—Å—è –≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞,
        –∞ —ç—Ç–∞ –ø–∞–Ω–µ–ª—å –ø–æ–º–æ–≥–∞–µ—Ç –∞–¥–º–∏–Ω–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞.
      </p>

      <div style="
          margin-top:10px;
          padding:10px 12px;
          border-radius:12px;
          background:linear-gradient(to right, #0f172a, #111827);
          color:#e5e7eb;
          font-size:12px;
          display:flex;
          gap:10px;
          align-items:flex-start;
      ">
        <div style="
            width:28px;
            height:28px;
            border-radius:6px;
            background:rgba(15,23,42,0.85);
            display:flex;
            align-items:center;
            justify-content:center;
            font-size:15px;
        ">
          üß©
        </div>
        <div>
          <div style="font-weight:600;margin-bottom:3px;">–°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏</div>
          <div>
            <strong>–ö–æ–º–∞–Ω–¥–∞</strong> ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç <strong>–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö</strong> ‚Üí –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–º
            <strong>–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞</strong>, –∫–æ—Ç–æ—Ä—ã–º –≤—ã —Ä–∞–∑—Ä–µ—à–∏–ª–∏ –¥–æ—Å—Ç—É–ø.
          </div>
        </div>
      </div>
    </section>

    {# –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ —á–µ–∫-–ª–∏—Å—Ç #}
    <aside style="
        border-radius:14px;
        background:white;
        box-shadow:0 14px 30px rgba(15,23,42,0.06);
        padding:14px 16px 16px;
        border:1px solid #e5e7eb;
        font-size:12px;
        color:#4b5563;
    ">
      <h3 style="font-size:13px;font-weight:600;margin:0 0 8px;color:#111827;">
        –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º / –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –±–æ—Ç–∞
      </h3>

      <ol style="margin:0 0 8px 18px;padding:0;list-style:decimal;">
        <li style="margin-bottom:4px;">
          –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ <strong>–∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö</strong> –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ —Å—Å—ã–ª–∞—é—Ç—Å—è
          –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
        </li>
        <li style="margin-bottom:4px;">
          –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <strong>–∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞</strong> ‚Äî –≤–∫–ª—é—á–µ–Ω—ã –ª–∏ –Ω—É–∂–Ω—ã–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–ø–∏—Å–∞–Ω—ã.
        </li>
        <li style="margin-bottom:4px;">
          –í—ã–¥–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Ç–µ–º <strong>–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞</strong>, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
          —Å –¥–∞–Ω–Ω—ã–º–∏.
        </li>
        <li style="margin-bottom:4px;">
          –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ <strong>–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –±–æ—Ç–∞</strong> –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
        </li>
      </ol>

      <div style="
          margin-top:8px;
          padding:8px 10px;
          border-radius:10px;
          background:#eff6ff;
          border:1px solid rgba(59,130,246,0.35);
          color:#1d4ed8;
          display:flex;
          align-items:flex-start;
          gap:6px;
      ">
        <span style="font-size:13px;">‚öôÔ∏è</span>
        <span>
          –î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É
          <strong>¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å¬ª</strong> –≤ –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏.
        </span>
      </div>
    </aside>
  </div>

  {# –í–¢–û–†–ê–Ø –°–¢–†–û–ö–ê: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 24 —á–∞—Å–∞ + –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è #}
  <div style="margin-top:16px; display:grid; grid-template-columns: minmax(0,1.4fr) minmax(0,2fr); gap:18px; align-items:flex-start;">

    {# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 24 —á–∞—Å–∞ #}
    <section style="
        border-radius:14px;
        background:white;
        box-shadow:0 14px 30px rgba(15,23,42,0.06);
        padding:14px 16px 16px;
        border:1px solid #e5e7eb;
        font-size:12px;
        color:#374151;
    ">
      <h3 style="font-size:13px;font-weight:600;margin:0 0 8px;color:#111827;">
        –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
      </h3>

      <ul style="margin:0 0 10px 16px;padding:0;list-style:disc;">
        <li>–°–æ–±—ã—Ç–∏–π: <strong>{{ events_count_24h|default:"0" }}</strong></li>
        <li>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <strong>{{ unique_users_24h|default:"0" }}</strong></li>
        <li>–û—à–∏–±–æ–∫:
          <strong{% if errors_24h %} style="color:#b91c1c;"{% endif %}>
            {{ errors_24h|default:"0" }}
          </strong>
        </li>
      </ul>

      <h4 style="font-size:12px;font-weight:600;margin:0 0 6px;color:#111827;">
        –¢–æ–ø –∫–æ–º–∞–Ω–¥
      </h4>
      {% if top_commands %}
        <table style="width:100%;border-collapse:collapse;font-size:12px;">
          <thead>
            <tr style="border-bottom:1px solid #e5e7eb;">
              <th style="text-align:left;padding:4px 4px;">–ö–æ–º–∞–Ω–¥–∞</th>
              <th style="text-align:right;padding:4px 4px;">–ó–∞ 24 —á–∞—Å–∞</th>
            </tr>
          </thead>
          <tbody>
            {% for row in top_commands %}
              <tr style="border-bottom:1px solid #f3f4f6;">
                <td style="padding:4px 4px;">{{ row.command|default:"(–±–µ–∑ –∫–æ–º–∞–Ω–¥—ã)" }}</td>
                <td style="padding:4px 4px;text-align:right;">{{ row.cnt }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p style="margin:4px 0 0;color:#9ca3af;">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –Ω–µ –±—ã–ª–æ —Å–æ–±—ã—Ç–∏–π.</p>
      {% endif %}
    </section>

    {# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è + –æ—à–∏–±–∫–∏ #}
    <section style="
        border-radius:14px;
        background:white;
        box-shadow:0 14px 30px rgba(15,23,42,0.06);
        padding:14px 16px 16px;
        border:1px solid #e5e7eb;
        font-size:12px;
        color:#374151;
    ">
      <h3 style="font-size:13px;font-weight:600;margin:0 0 8px;color:#111827;">
        –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –±–æ—Ç—É
      </h3>

      {% if recent_events %}
        <table style="width:100%;border-collapse:collapse;font-size:12px;">
          <thead>
            <tr style="border-bottom:1px solid #e5e7eb;">
              <th style="text-align:left;padding:4px 4px;">–í—Ä–µ–º—è</th>
              <th style="text-align:left;padding:4px 4px;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
              <th style="text-align:left;padding:4px 4px;">–ö–æ–º–∞–Ω–¥–∞</th>
              <th style="text-align:right;padding:4px 4px;">–°—Ç–∞—Ç—É—Å</th>
            </tr>
          </thead>
          <tbody>
            {% for ev in recent_events %}
              <tr style="border-bottom:1px solid #f3f4f6;">
                <td style="padding:4px 4px;white-space:nowrap;">{{ ev.created_at|date:"d.m H:i" }}</td>
                <td style="padding:4px 4px;">
                  {% if ev.user %}
                    {{ ev.user.get_full_name|default:ev.user.username }}
                  {% else %}
                    {{ ev.telegram_username|default:ev.telegram_id }}
                  {% endif %}
                </td>
                <td style="padding:4px 4px;">{{ ev.command|default:"(–±–µ–∑ –∫–æ–º–∞–Ω–¥—ã)" }}</td>
                <td style="padding:4px 4px;text-align:right;">
                  {% if ev.status == "error" %}
                    <span style="color:#b91c1c;">–û—à–∏–±–∫–∞</span>
                  {% else %}
                    <span style="color:#16a34a;">–û–∫</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p style="margin:0;color:#9ca3af;">–°–æ–±—ã—Ç–∏–π –ø–æ–∫–∞ –Ω–µ—Ç.</p>
      {% endif %}

      {% if last_errors %}
        <h4 style="font-size:12px;font-weight:600;margin:10px 0 4px;color:#b91c1c;">
          –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
        </h4>
        <ul style="margin:0 0 0 16px;padding:0;list-style:disc;">
          {% for ev in last_errors %}
            <li style="margin-bottom:2px;">
              {{ ev.created_at|date:"d.m H:i" }} ‚Äî {{ ev.command|default:"(–±–µ–∑ –∫–æ–º–∞–Ω–¥—ã)" }}:
              {{ ev.error_message|default:"–û—à–∏–±–∫–∞ –±–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è" }}
            </li>
          {% endfor %}
        </ul>
      {% endif %}
    </section>
  </div>
{% endblock %}

{% block extrahead %}
  {{ block.super }}
{% endblock %}

{% block content %}
  {{ block.super }}
{% endblock %}
